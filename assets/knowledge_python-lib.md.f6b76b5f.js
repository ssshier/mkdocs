import{_ as s,c as n,o as a,a as l}from"./app.2776b6d2.js";const C=JSON.parse('{"title":"Python Lib","description":"","frontmatter":{},"headers":[{"level":2,"title":"SQLAlchemy","slug":"sqlalchemy"},{"level":2,"title":"Numpy","slug":"numpy"},{"level":2,"title":"Pandas","slug":"pandas"},{"level":2,"title":"Pika","slug":"pika"},{"level":2,"title":"JPype","slug":"jpype"},{"level":2,"title":"Python for Excel","slug":"python-for-excel"}],"relativePath":"knowledge/python-lib.md","lastUpdated":1666237138000}'),p={name:"knowledge/python-lib.md"},o=l(`<h1 id="python-lib" tabindex="-1">Python Lib <a class="header-anchor" href="#python-lib" aria-hidden="true">#</a></h1><nav class="table-of-contents"><ul><li><a href="#sqlalchemy">SQLAlchemy</a></li><li><a href="#numpy">Numpy</a></li><li><a href="#pandas">Pandas</a></li><li><a href="#pika">Pika</a></li><li><a href="#jpype">JPype</a></li><li><a href="#python-for-excel">Python for Excel</a></li></ul></nav><h2 id="sqlalchemy" tabindex="-1">SQLAlchemy <a class="header-anchor" href="#sqlalchemy" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">SQLAlchemy \u6587\u6863</p><p><a href="https://docs.sqlalchemy.org/en/14/" target="_blank" rel="noreferrer">https://docs.sqlalchemy.org/en/14/</a></p><p><a href="https://docs.sqlalchemy.org/en/20/" target="_blank" rel="noreferrer">https://docs.sqlalchemy.org/en/20/</a></p></div><div class="language-Python"><button class="copy"></button><span class="lang">Python</span><pre><code><span class="line"><span style="color:#676E95;"># PostgreSQL</span></span>
<span class="line"><span style="color:#676E95;"># default</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">postgresql://scott:tiger@localhost/mydatabase</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># psycopg2</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">postgresql+psycopg2://scott:tiger@localhost/mydatabase</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># pg8000</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">postgresql+pg8000://scott:tiger@localhost/mydatabase</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># MySQL</span></span>
<span class="line"><span style="color:#676E95;"># default</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mysql://scott:tiger@localhost/foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># mysqlclient (a maintained fork of MySQL-Python)</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mysql+mysqldb://scott:tiger@localhost/foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># PyMySQL</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mysql+pymysql://scott:tiger@localhost/foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Oracle</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">oracle://scott:tiger@127.0.0.1:1521/sidname</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">oracle+cx_oracle://scott:tiger@tnsname</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Microsoft SQL Server</span></span>
<span class="line"><span style="color:#676E95;"># pyodbc</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mssql+pyodbc://scott:tiger@mydsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># pymssql</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mssql+pymssql://scott:tiger@hostname:port/dbname</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># SQLite</span></span>
<span class="line"><span style="color:#676E95;"># sqlite://&lt;nohostname&gt;/&lt;path&gt;</span></span>
<span class="line"><span style="color:#676E95;"># where &lt;path&gt; is relative:</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sqlite:///foo.db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># Unix/Mac - 4 initial slashes in total</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sqlite:////absolute/path/to/foo.db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># Windows</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sqlite:///C:</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">path</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">foo.db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># Windows alternative using raw string</span></span>
<span class="line"><span style="color:#A6ACCD;">engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_engine</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">r</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sqlite:///C:</span><span style="color:#A6ACCD;">\\p</span><span style="color:#C3E88D;">ath</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">o</span><span style="color:#A6ACCD;">\\f</span><span style="color:#C3E88D;">oo.db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="numpy" tabindex="-1">Numpy <a class="header-anchor" href="#numpy" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">Numpy \u6587\u6863</p><p><a href="https://numpy.org/doc/stable/user/index.html#user" target="_blank" rel="noreferrer">https://numpy.org/doc/stable/user/index.html#user</a></p></div><h2 id="pandas" tabindex="-1">Pandas <a class="header-anchor" href="#pandas" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">Pandas \u6587\u6863</p><p><a href="https://pandas.pydata.org/docs/user_guide/index.html" target="_blank" rel="noreferrer">https://pandas.pydata.org/docs/user_guide/index.html</a></p></div><h2 id="pika" tabindex="-1">Pika <a class="header-anchor" href="#pika" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">Pika \u6587\u6863</p><p><a href="https://pika.readthedocs.io/en/stable/" target="_blank" rel="noreferrer">https://pika.readthedocs.io/en/stable/</a></p></div><div class="language-Python"><button class="copy"></button><span class="lang">Python</span><pre><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> pika</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">credentials </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">PlainCredentials</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># mq\u7528\u6237\u540D\u548C\u5BC6\u7801</span></span>
<span class="line"><span style="color:#676E95;"># \u865A\u62DF\u961F\u5217\u9700\u8981\u6307\u5B9A\u53C2\u6570 virtual_host, \u5982\u679C\u662F\u9ED8\u8BA4\u7684\u53EF\u4EE5\u4E0D\u586B</span></span>
<span class="line"><span style="color:#A6ACCD;">connection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">BlockingConnection</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ConnectionParameters</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#A6ACCD;">host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">port</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">5672</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">virtual_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">credentials</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">credentials</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">channel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">channel</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#676E95;"># \u58F0\u660Eexchange, \u7531exchange\u6307\u5B9A\u6D88\u606F\u5728\u54EA\u4E2A\u961F\u5217\u4F20\u9012, \u5982\u4E0D\u5B58\u5728, \u5219\u521B\u5EFA.durable = True \u4EE3\u8868exchange\u6301\u4E45\u5316\u5B58\u50A8, False \u975E\u6301\u4E45\u5316\u5B58\u50A8</span></span>
<span class="line"><span style="color:#A6ACCD;">channel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exchange_declare</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">exchange</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">python-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">durable</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#676E95;"># \u58F0\u660E\u6D88\u606F\u961F\u5217, \u6D88\u606F\u5C06\u5728\u8FD9\u4E2A\u961F\u5217\u4F20\u9012, \u5982\u4E0D\u5B58\u5728, \u5219\u521B\u5EFA. durable = True \u4EE3\u8868\u6D88\u606F\u961F\u5217\u6301\u4E45\u5316\u5B58\u50A8, False \u975E\u6301\u4E45\u5316\u5B58\u50A8</span></span>
<span class="line"><span style="color:#A6ACCD;">result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> channel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">queue_declare</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">queue</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">python-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">durable</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">range</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    message </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> json</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dumps</span><span style="color:#89DDFF;">({</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> i</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># \u5411\u961F\u5217\u63D2\u5165\u6570\u503C routing_key\u662F\u961F\u5217\u540D</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># delivery_mode = 2 \u58F0\u660E\u6D88\u606F\u5728\u961F\u5217\u4E2D\u6301\u4E45\u5316, delivery_mod = 1 \u6D88\u606F\u975E\u6301\u4E45\u5316</span></span>
<span class="line"><span style="color:#A6ACCD;">    channel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basic_publish</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#A6ACCD;">exchange</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#A6ACCD;">routing_key</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">python-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">message</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">BasicProperties</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">delivery_mode</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">message</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Consumer</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> pika</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">credentials </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">PlainCredentials</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">connection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">BlockingConnection</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    pika</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ConnectionParameters</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#A6ACCD;">host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">port</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">5672</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">virtual_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">credentials</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">credentials</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">channel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">channel</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#676E95;"># \u7533\u660E\u6D88\u606F\u961F\u5217, \u6D88\u606F\u5728\u8FD9\u4E2A\u961F\u5217\u4F20\u9012, \u5982\u679C\u4E0D\u5B58\u5728, \u5219\u521B\u5EFA\u961F\u5217</span></span>
<span class="line"><span style="color:#A6ACCD;">channel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">queue_declare</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">queue</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">python-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">durable</span><span style="color:#89DDFF;">=False)</span></span>
<span class="line"><span style="color:#676E95;"># \u5B9A\u4E49\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u6765\u5904\u7406\u6D88\u606F\u961F\u5217\u4E2D\u7684\u6D88\u606F, \u8FD9\u91CC\u662F\u6253\u5370\u51FA\u6765</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">callback</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ch</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">method</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">properties</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    ch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basic_ack</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">delivery_tag</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">method</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">delivery_tag</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">body</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decode</span><span style="color:#89DDFF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u7528callback\u6765\u63A5\u6536\u6D88\u606F</span></span>
<span class="line"><span style="color:#676E95;"># no_ack \u8BBE\u7F6E\u6210 False, \u5728\u8C03\u7528callback\u51FD\u6570\u65F6, \u672A\u6536\u5230\u786E\u8BA4\u6807\u8BC6, \u6D88\u606F\u4F1A\u91CD\u56DE\u961F\u5217. True, \u65E0\u8BBA\u8C03\u7528callback\u6210\u529F\u4E0E\u5426, \u6D88\u606F\u90FD\u88AB\u6D88\u8D39\u6389</span></span>
<span class="line"><span style="color:#A6ACCD;">channel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basic_consume</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">python-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> callback</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">no_ack</span><span style="color:#89DDFF;">=False)</span></span>
<span class="line"><span style="color:#676E95;"># \u5F00\u59CB\u63A5\u6536\u4FE1\u606F, \u5E76\u8FDB\u5165\u963B\u585E\u72B6\u6001, \u961F\u5217\u91CC\u6709\u4FE1\u606F\u624D\u4F1A\u8C03\u7528callback\u8FDB\u884C\u5904\u7406</span></span>
<span class="line"><span style="color:#A6ACCD;">channel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">start_consuming</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span></code></pre></div><h2 id="jpype" tabindex="-1">JPype <a class="header-anchor" href="#jpype" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">JPype \u6587\u6863</p><p><a href="https://jpype.readthedocs.io/en/latest/userguide.html" target="_blank" rel="noreferrer">https://jpype.readthedocs.io/en/latest/userguide.html</a></p></div><p>JPype is a Python module to provide full access to Java from within Python.</p><div class="language-Python"><button class="copy"></button><span class="lang">Python</span><pre><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> jpype</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">jpype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startJVM</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">jpype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">shutdownJVM</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">jpype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getDefaultJVMPath</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">jpype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getClassPath</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">env</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">jpype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">JPackage</span><span style="color:#89DDFF;">(*</span><span style="color:#82AAFF;">args</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">**</span><span style="color:#82AAFF;">kwargs</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">jpype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">JClass</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">jc</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">loader</span><span style="color:#89DDFF;">=None,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">initialize</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"></span></code></pre></div><h2 id="python-for-excel" tabindex="-1">Python for Excel <a class="header-anchor" href="#python-for-excel" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">Python for Excel</p><p><a href="https://www.python-excel.org/" target="_blank" rel="noreferrer">https://www.python-excel.org/</a></p></div>`,18),e=[o];function t(c,r,F,D,y,A){return a(),n("div",null,e)}const h=s(p,[["render",t]]);export{C as __pageData,h as default};
